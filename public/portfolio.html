<!doctype html>
<html class="light dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Work â€“ Software Developer Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#0D47A1",
                        secondary: "#4285F4",
                        "text-heading": "#212529",
                        "text-body": "#495057",
                        "background-light": "#F8F9FA",
                        "background-dark": "#101622",
                    },
                    fontFamily: { display: ["Inter", "sans-serif"] },
                },
            },
        };
    </script>

    <style>
        .material-symbols-outlined {
            font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        html.dark {
            background-color: #101622 !important;
        }

        html.dark body {
            background-color: #101622 !important;
        }

        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #F8F9FA;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }

        html.dark #page-loader {
            background: #0f172a;
        }

        #page-loader.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #e2e8f0;
            border-top-color: #0D47A1;
            border-right-color: #4285F4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body
    class="font-display bg-background-light dark:bg-background-dark text-text-body dark:text-gray-300 min-h-screen transition-colors duration-300">

    <!-- Loader -->
    <div id="page-loader">
        <div class="text-center">
            <div class="loader-spinner mx-auto mb-4"></div>
            <p class="text-primary font-semibold">Loading Portfolio...</p>
        </div>
    </div>

    <div class="flex flex-col min-h-screen">

        <!-- Header -->
        <header
            class="sticky top-0 z-50 bg-background-light dark:bg-background-dark/80 backdrop-blur-md border-b border-gray-200/60 dark:border-gray-800/60 px-5 py-5">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl md:text-3xl font-bold text-text-heading dark:text-white">My Work</h1>
            <div class="flex items-center gap-4">
                <button id="theme-toggle"
                        class="p-2.5 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition">
                        <svg id="sun-icon" class="w-6 h-6 hidden text-yellow-500" fill="currentColor"
                            viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                            clip-rule="evenodd" />
                    </svg>
                    <svg id="moon-icon" class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="currentColor"
                        viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
                    </svg>
                </button>
                    <span class="material-symbols-outlined text-3xl cursor-pointer select-none">menu</span>
                </div>
            </div>
        </header>

        <!-- Filter Bar -->
        <section class="px-5 pt-6">
            <div id="portfolio-filter-bar" class="flex gap-3 overflow-x-auto scrollbar-hide pb-2"></div>
        </section>

        <!-- Last Updated -->
        <div class="px-5 mt-4 mb-6">
            <p class="text-xs text-gray-500 dark:text-gray-400">
                Last updated: <strong>November 20, 2025</strong>
            </p>
        </div>

        <!-- Projects Grid -->
        <main class="flex-1 px-4 sm:px-6 pb-12">
            <div id="projects-container"
                class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 sm:gap-6 lg:gap-8 auto-rows-fr">
                <!-- Cards injected here -->
            </div>
        </main>
    </div>

    <script>
        let projects = [], categories = [], activeFilter = "all";
        const container = document.getElementById("projects-container");
        const filterBar = document.getElementById("portfolio-filter-bar");

        function renderFilterButtons() {
            filterBar.innerHTML = `<button class="filter-btn h-10 px-6 rounded-full transition-all ${activeFilter === 'all' ? 'bg-primary text-white shadow-lg' : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'}" data-filter="all">All Projects</button>`;
            categories.forEach(cat => {
                const btn = document.createElement("button");
                btn.className = `filter-btn h-10 px-6 rounded-full transition-all ${activeFilter === cat.slug ? 'bg-primary text-white shadow-lg' : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'}`;
                btn.textContent = cat.label;
                btn.dataset.filter = cat.slug;
                btn.onclick = () => { activeFilter = cat.slug; renderFilterButtons(); renderProjects(); };
                filterBar.appendChild(btn);
            });
        }

        function renderProjects(filter = "all") {
            container.innerHTML = "";
            const filtered = filter === "all" ? projects : projects.filter(p => p.category === filter);

            if (!filtered.length) {
                container.innerHTML = `<p class="col-span-full text-center py-20 text-gray-500 dark:text-gray-400 text-lg">No projects in this category yet.</p>`;
                return;
            }

            filtered.forEach((proj, i) => {
                const card = document.createElement("div");
                card.className = "opacity-0 translate-y-12 transition-all duration-700 ease-out";
                card.style.animationDelay = `${i * 100}ms`;

                card.innerHTML = `
          <article class="group h-full bg-white dark:bg-gray-800/70 rounded-2xl sm:rounded-3xl overflow-hidden shadow-lg border border-gray-200/60 dark:border-gray-700/50 
                          hover:shadow-2xl hover:-translate-y-3 transition-all duration-500 flex flex-col">

            <!-- Responsive Image - Square on mobile -->
            <div class="relative aspect-square sm:aspect-[4/3] overflow-hidden bg-gray-100 dark:bg-gray-900">
              <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-110"
                   style="background-image: url('${proj.image || 'https://images.unsplash.com/photo-1517180107641-2d1a4e0b7e3e?w=800&q=80'}')"></div>
              <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
            </div>

            <!-- Card Content - Compact on mobile -->
            <div class="p-3 sm:p-6 flex flex-col flex-1 justify-between">
            <div>
                <h3 class="text-base sm:text-xl font-bold text-gray-900 dark:text-white line-clamp-2 leading-tight mb-1.5 sm:mb-2">
                ${proj.title}
              </h3>
                <p class="text-xs sm:text-base text-gray-600 dark:text-gray-300 line-clamp-2 sm:line-clamp-3 leading-snug sm:leading-relaxed">
                  ${proj.description}
              </p>
            </div>

              <div class="flex flex-wrap gap-1.5 sm:gap-2 mt-2.5 sm:mt-4">
                ${proj.tags?.map(t =>
                    `<span class="px-2 py-1 sm:px-3 sm:py-1.5 text-[10px] sm:text-xs font-medium rounded-full bg-secondary/10 dark:bg-secondary/20 text-secondary">
                    ${t}
                  </span>`
                ).join("") || ''}
              </div>

              <a href="${proj.href}" target="_blank" rel="noopener noreferrer"
                 class="mt-3 sm:mt-6 w-full py-2.5 sm:py-3.5 bg-primary hover:bg-primary/90 text-white font-semibold text-center rounded-xl sm:rounded-2xl transition-all shadow-md hover:shadow-lg text-xs sm:text-sm">
                View Project
              </a>
            </div>
          </article>
      `;

                container.appendChild(card);
                setTimeout(() => card.classList.replace("opacity-0", "opacity-100"), 50);
            });
        }

        // Load real data or fallback
        async function loadProjects() {
            try {
                const res = await fetch("/api/portfolio");
                if (!res.ok) throw new Error();
                const data = await res.json();
                projects = data.projects || [];
                categories = [{ slug: "all", label: "All Projects" }, ...(data.categories || [])];
            } catch (e) {
                // Demo data if API fails
                projects = [
                    { title: "E-Commerce Platform", description: "Modern online store with Stripe & Next.js", image: "", tags: ["Next.js", "Node"], category: "web", href: "#" },
                    { title: "AI Analytics Dashboard", description: "Real-time insights powered by machine learning", image: "", tags: ["React", "Python"], category: "ai", href: "#" },
                    { title: "Mobile Banking App", description: "Secure finance app for iOS & Android", image: "", tags: ["React Native"], category: "mobile", href: "#" },
                    { title: "SaaS Marketing Site", description: "High-conversion landing page system", image: "", tags: ["Tailwind", "Vue"], category: "web", href: "#" }
                ];
                categories = [{ slug: "all", label: "All Projects" }, { slug: "web", label: "Web" }, { slug: "mobile", label: "Mobile" }, { slug: "ai", label: "AI" }];
            }
            renderFilterButtons();
            renderProjects();
            setTimeout(() => document.getElementById("page-loader").classList.add("hidden"), 800);
        }

        // Theme toggle
        const html = document.documentElement;
        const themeToggle = document.getElementById("theme-toggle");
        const sun = document.getElementById("sun-icon");
        const moon = document.getElementById("moon-icon");

        if (localStorage.theme === "dark" || (!localStorage.theme && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
            html.classList.add("dark");
            sun.classList.remove("hidden");
            moon.classList.add("hidden");
        }

        themeToggle.addEventListener("click", () => {
            html.classList.toggle("dark");
            if (html.classList.contains("dark")) {
                localStorage.theme = "dark";
                sun.classList.remove("hidden");
                moon.classList.add("hidden");
            } else {
                localStorage.theme = "light";
                sun.classList.add("hidden");
                moon.classList.remove("hidden");
            }
        });

        // Start
        loadProjects();
        setTimeout(() => document.getElementById("page-loader").classList.add("hidden"), 2500);
    </script>
</body>

</html>